---
import { Image } from 'astro:assets';
import { Button } from '../starwind/button';
import { Dropdown, DropdownTrigger, DropdownContent, DropdownItem } from '@/components/starwind/dropdown';
import { Sheet, SheetTrigger, SheetContent, SheetHeader, SheetTitle } from '@/components/starwind/sheet';
import { PhoneIcon, MailIcon, ChevronDownIcon, MenuIcon } from '@lucide/astro';
import { getRelativeLocaleUrl } from 'astro:i18n';

import settingsData from '@/data/settings.yaml';

interface MenuChild {
  label: string;
  url: string;
}

interface MenuItem {
  label: string;
  url: string;
  children?: MenuChild[];
}

interface Settings {
  phone: string;
  email: string;
  requestCallbackBtn: string;
  headerMenu: MenuItem[];
}

const { lang } = Astro.props;
const currentLangLabel = lang === 'en' ? 'EN' : 'AR';

const settings = settingsData[lang] as Settings;
---

<header class="py-2">
  <div class="container">
    <div class="flex items-center justify-between md:mb-5">
      <div class="flex items-center gap-2">
        <a href={getRelativeLocaleUrl(lang)}>
          <Image src={import('@/assets/logo.png')} alt="logo" class="h-15 w-auto" />
        </a>
        <div class="hidden md:flex items-center gap-5">
          <a href={`tel:${settings.phone}`} class="text-black lg:text-xl font-medium flex items-center gap-2"> <PhoneIcon size={20} />{settings.phone}</a>
          <a href={`mailto:${settings.email}`} class="text-black lg:text-xl font-medium flex items-center gap-2"> <MailIcon size={20} />{settings.email}</a>
        </div>
      </div>
      <div class="flex items-center gap-5">
        <div class="flex items-center gap-5">
          <Button class="button">{settings.requestCallbackBtn}</Button>
          <Dropdown class="hidden md:block">
            <DropdownTrigger asChild>
              <Button variant="outline">{currentLangLabel} <ChevronDownIcon size={24} /> </Button>
            </DropdownTrigger>
            <DropdownContent align="end">
              <DropdownItem><a href={getRelativeLocaleUrl('en')} class="block w-full">EN</a></DropdownItem>
              <DropdownItem><a href={getRelativeLocaleUrl('ar')} class="block w-full">AR</a></DropdownItem>
            </DropdownContent>
          </Dropdown>
        </div>

        <Sheet>
          <SheetTrigger asChild class="md:hidden">
            <MenuIcon size={24} />
          </SheetTrigger>
          <SheetContent side="right">
            <nav class="flex flex-col gap-6 p-8">
              <ul class="flex flex-col gap-4 font-medium text-lg">
                {
                  settings.headerMenu.map((item) => (
                    <li>
                      <a href={item.url} class="text-[#916a2a] hover:text-[#b79647] transition-colors">
                        {item.label}
                      </a>
                    </li>
                  ))
                }
              </ul>

              <div class="flex flex-col gap-3 pt-6 border-t border-[#b79647]/30">
                <a href={`tel:${settings.phone}`} class="text-[#916a2a] text-lg font-medium flex items-center gap-2">
                  <PhoneIcon size={20} />{settings.phone}
                </a>
                <a href={`mailto:${settings.email}`} class="text-[#916a2a] text-lg font-medium flex items-center gap-2">
                  <MailIcon size={20} />{settings.email}
                </a>
              </div>

              <div class="flex flex-col gap-4 pt-4">
                <div class="flex items-center justify-center gap-2">
                  <a href={getRelativeLocaleUrl('en')} class="flex-1"><Button variant="outline" class="w-full">EN</Button></a>
                  <a href={getRelativeLocaleUrl('ar')} class="flex-1"><Button variant="outline" class="w-full">AR</Button></a>
                </div>
              </div>
            </nav>
          </SheetContent>
        </Sheet>
      </div>
    </div>
  </div>

  <nav class="hidden md:block bg-primary-light/60 rounded-lg px-8 py-1">
    <div class="container">
      <ul class="flex items-center gap-10 font-medium lg:text-xl">
        {
          settings.headerMenu.map((item) => (
            <li>
              <a href={item.url}>{item.label}</a>
            </li>
          ))
        }
      </ul>
    </div>
  </nav>
</header>
